#!/usr/bin/env ruby

def print_and_descend(depth=1)
  directories = []
  Dir.pwd =~ /\/(\w*)$/
  puts "#{  ' '*depth*2}->#{$1}/"
  Dir['*'].sort.each do |path|
    if File.file? path
      puts "#{' '*depth*2}|#{path}"
    else
      directories << path
    end
  end

  # Remove . and .. directories, if present
  directories.reject! do |path|
    path =~ /\.+$/
  end

  directories.each do |path|
    Dir.chdir(path) do
      depth += 1
      print_and_descend depth
    end
  end
end

def print_root(path)
  pattern = /^#{ENV['HOME']}/
  path.sub! pattern, '~'
  puts path.upcase
end

def print_root_then_tree
  print_root Dir.pwd
  print_and_descend
end

print_root_then_tree



