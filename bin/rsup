#!/bin/bash
#
# starts rails or middleman server
# opens with the port configured for pow DNS
# copies the ".dev" URL

app_name=$(basename `pwd`)
port=`cat ~/.pow/$app_name 2> /dev/null`
if [[ -f config/environment.rb ]]; then
  server_cmd="bundle exec rails s"
else
  server_cmd="middleman"
fi
if [[ -n $port ]]; then
  echo "http://`basename $(pwd)`.dev" | pbcopy
  echo "Dev URL loaded into clipboard"
  eval $server_cmd -p $port
else
  echo "http://localhost:3000" | pbcopy
  echo "Dev URL loaded into clipboard"
  eval $server_cmd
fi
